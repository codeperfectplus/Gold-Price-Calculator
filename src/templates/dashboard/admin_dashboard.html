{% extends "base/base.html" %}

{% block title %}Admin Dashboard{% endblock %}

{% block styles %}
<link rel="stylesheet" href="{{ url_for('static', filename='css/dashboard.css') }}">
<link rel="stylesheet" href="{{ url_for('static', filename='css/admin_dashboard.css') }}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
{% endblock %}

{% block content %}
<div class="admin-dashboard">
    <h2 class="dashboard-title"><i class="fas fa-tachometer-alt"></i> Admin Dashboard</h2>
    <p class="welcome-message">Welcome, {{ current_user.username }}!</p>
    <!-- Display flash messages -->
    {% include "ext/flash_message.html" %}
    
    <div class="stats-cards">
        <div class="card">
            <i class="fas fa-users card-icon"></i>
            <h3>Total Users</h3>
            <p>{{ total_users }}</p>
        </div>
        <div class="card">
            <i class="fas fa-network-wired card-icon"></i>
            <h3>Sessions</h3>
            <p>{{ active_sessions }}</p>
        </div>
        <div class="card">
            <i class="fas fa-heartbeat card-icon"></i>
            <h3>Health</h3>
            <p>{{ system_health }}</p>
        </div>
        <div class="card">
            <i class="fas fa-microchip card-icon"></i>
            <h3>CPU Core</h3>
            <p>{{ cpu_core }}</p>
        </div>
        <div class="card">
            <i class="fas fa-tachometer-alt card-icon"></i>
            <h3>CPU Utilization</h3>
            <p>{{ cpu_util }}</p>
        </div>
        <!-- last password change -->
        <div class="card">
            <i class="fas fa-key card-icon"></i>
            <h3>Last Password Change</h3>
            <p>{{ current_user.last_password_change | format_datetime('%Y-%m-%d %H:%M:%S') }}</p>
        </div>
    </div>

    <div class="admin-tools">
        <h3><i class="fas fa-tools"></i> Admin Tools</h3>
        <div class="button-grid">
            <a href="{{ url_for('users_.manage_users') }}" class="btn btn-large"><i class="fas fa-user-cog"></i> User Management</a>
            <a href="{{ url_for('admin_.history') }}" class="btn btn-large"><i class="fas fa-history"></i>Transaction History</a>
            <a href="{{ url_for('admin_.settings') }}" class="btn btn-large"><i class="fas fa-cog"></i> System Settings</a>
            <a href="{{ url_for('admin_.audit_log') }}" class="btn btn-large"><i class="fas fa-clipboard-list"></i> Audit Logs</a>
            <a href="{{ url_for('admin_.update_jeweller_details') }}" class="btn btn-large"><i class="fas fa-cog"></i>Jewellers Config Settings</a>
            <a href="{{ url_for('auth.change_password') }}" class="btn btn-large"><i class="fas fa-key"></i> Change Password</a>
        </div>
    </div>
    <div class="admin-dashboard">
        <h3><i class="fas fa-history"></i> Recent Activity</h3>
        {% for log in audit_logs %}
        <p>{{ log.timestamp }} - {{ log.action }}</p>
        <p> {{ log.details }}</p>
        <hr>
        {% endfor %}
    </div>
</div>
{% endblock %}
